<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of fastica</title>
  <meta name="keywords" content="fastica">
  <meta name="description" content="FASTICA - Fast Independent Component Analysis">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../index.html">Home</a> &gt;  <a href="index.html">FastICA_25</a> &gt; fastica.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../index.html"><img alt="<" border="0" src="../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for FastICA_25&nbsp;<img alt=">" border="0" src="../right.png"></a></td></tr></table>-->

<h1>fastica
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>FASTICA - Fast Independent Component Analysis</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function [Out1, Out2, Out3] = fastica(mixedsig, varargin) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment">FASTICA - Fast Independent Component Analysis

 FastICA for Matlab 7.x and 6.x
 Version 2.5, October 19 2005
 Copyright (c) Hugo Gävert, Jarmo Hurri, Jaakko Särelä, and Aapo Hyvärinen.

 FASTICA(mixedsig) estimates the independent components from given
 multidimensional signals. Each row of matrix mixedsig is one
 observed signal.  FASTICA uses Hyvarinen's fixed-point algorithm,
 see http://www.cis.hut.fi/projects/ica/fastica/. Output from the
 function depends on the number output arguments:

 [icasig] = FASTICA (mixedsig); the rows of icasig contain the
 estimated independent components.

 [icasig, A, W] = FASTICA (mixedsig); outputs the estimated separating
 matrix W and the corresponding mixing matrix A.

 [A, W] = FASTICA (mixedsig); gives only the estimated mixing matrix
 A and the separating matrix W.

 Some optional arguments induce other output formats, see below.

 A graphical user interface for FASTICA can be launched by the
 command FASTICAG

 FASTICA can be called with numerous optional arguments. Optional
 arguments are given in parameter pairs, so that first argument is
 the name of the parameter and the next argument is the value for
 that parameter. Optional parameter pairs can be given in any order.

 OPTIONAL PARAMETERS:

 Parameter name        Values and description

======================================================================
 --Basic parameters in fixed-point algorithm:

 'approach'            (string) The decorrelation approach used. Can be
                       symmetric ('symm'), i.e. estimate all the
                       independent component in parallel, or
                       deflation ('defl'), i.e. estimate independent
                       component one-by-one like in projection pursuit.
                       Default is 'defl'.

 'numOfIC'             (integer) Number of independent components to
                       be estimated. Default equals the dimension of data.

======================================================================
 --Choosing the nonlinearity:

 'g'                   (string) Chooses the nonlinearity g used in 
                       the fixed-point algorithm. Possible values:

                       Value of 'g':      Nonlinearity used:
                       'pow3' (default)   g(u)=u^3
                       'tanh'             g(u)=tanh(a1*u)
                       'gauss             g(u)=u*exp(-a2*u^2/2)
                       'skew'             g(u)=u^2
 
 'finetune'        (string) Chooses the nonlinearity g used when 
                       fine-tuning. In addition to same values
                       as for 'g', the possible value 'finetune' is:
                       'off'              fine-tuning is disabled.

 'a1'                  (number) Parameter a1 used when g='tanh'.
                       Default is 1.
 'a2'                  (number) Parameter a2 used when g='gaus'.
                       Default is 1.

 'mu'            (number) Step size. Default is 1.
                       If the value of mu is other than 1, then the
                       program will use the stabilized version of the
                       algorithm (see also parameter 'stabilization').


 'stabilization'       (string) Values 'on' or 'off'. Default 'off'.
                       This parameter controls wether the program uses
                       the stabilized version of the algorithm or
                       not. If the stabilization is on, then the value
                       of mu can momentarily be halved if the program
                       senses that the algorithm is stuck between two
                       points (this is called a stroke). Also if there
                       is no convergence before half of the maximum
                       number of iterations has been reached then mu
                       will be halved for the rest of the rounds.

======================================================================
 --Controlling convergence:

 'epsilon'             (number) Stopping criterion. Default is 0.0001.

 'maxNumIterations'    (integer) Maximum number of iterations.
                       Default is 1000.

 'maxFinetune'         (integer) Maximum number of iterations in
                       fine-tuning. Default 100.

 'sampleSize'          (number) [0 - 1] Percentage of samples used in
                       one iteration. Samples are chosen in random.
                       Default is 1 (all samples).

 'initGuess'           (matrix) Initial guess for A. Default is random.
                       You can now do a &quot;one more&quot; like this:
                       [ica, A, W] = fastica(mix, 'numOfIC',3);
                       [ica2, A2, W2] = fastica(mix, 'initGuess', A, 'numOfIC', 4);

======================================================================
 --Graphics and text output:

 'verbose'             (string) Either 'on' or 'off'. Default is
                       'on': report progress of algorithm in text format.

 'displayMode'         (string) Plot running estimates of independent
                       components: 'signals', 'basis', 'filters' or
                       'off'. Default is 'off'.

 'displayInterval'     Number of iterations between plots.
                       Default is 1 (plot after every iteration).

======================================================================
 --Controlling reduction of dimension and whitening:

 Reduction of dimension is controlled by 'firstEig' and 'lastEig', or
 alternatively by 'interactivePCA'.

 'firstEig'            (integer) This and 'lastEig' specify the range for
                       eigenvalues that are retained, 'firstEig' is
                       the index of largest eigenvalue to be
                       retained. Default is 1.

 'lastEig'             (integer) This is the index of the last (smallest)
                       eigenvalue to be retained. Default equals the
                       dimension of data.

 'interactivePCA'      (string) Either 'on' or 'off'. When set 'on', the
                       eigenvalues are shown to the user and the
                       range can be specified interactively. Default
                       is 'off'. Can also be set to 'gui'. Then the user
                       can use the same GUI that's in <a href="fasticag.html" class="code" title="function fasticag(mixedsig, InitialGuess)">FASTICAG</a>.

 If you already know the eigenvalue decomposition of the covariance
 matrix, you can avoid computing it again by giving it with the
 following options:

 'pcaE'                (matrix) Eigenvectors
 'pcaD'                (matrix) Eigenvalues

 If you already know the whitened data, you can give it directly to
 the algorithm using the following options:

 'whiteSig'            (matrix) Whitened signal
 'whiteMat'            (matrix) Whitening matrix
 'dewhiteMat'          (matrix) dewhitening matrix

 If values for all the 'whiteSig', 'whiteSig' and 'dewhiteMat' are
 supplied, they will be used in computing the ICA. PCA and whitening
 are not performed. Though 'mixedsig' is not used in the main
 algorithm it still must be entered - some values are still
 calculated from it.

 Performing preprocessing only is possible by the option:

 'only'                (string) Compute only PCA i.e. reduction of
                       dimension ('pca') or only PCA plus whitening
                       ('white'). Default is 'all': do ICA estimation
                       as well.  This option changes the output
                       format accordingly. For example:

                       [whitesig, WM, DWM] = FASTICA(mixedsig,
                       'only', 'white')
                       returns the whitened signals, the whitening matrix
                       (WM) and the dewhitening matrix (DWM). (See also
                       <a href="whitenv.html" class="code" title="function [newVectors, whiteningMatrix, dewhiteningMatrix] = whitenv(vectors, E, D, s_verbose);">WHITENV</a>.) In <a href="fastica.html" class="code" title="function [Out1, Out2, Out3] = fastica(mixedsig, varargin)">FastICA</a> the whitening matrix performs
                       whitening and the reduction of dimension. Dewhitening
                       matrix is the pseudoinverse of whitening matrix.

                       [E, D] = FASTICA(mixedsig, 'only', 'pca')
                       returns the eigenvector (E) and diagonal
                       eigenvalue (D) matrices  containing the
                       selected subspaces.

======================================================================
 EXAMPLES

       [icasig] = <a href="fastica.html" class="code" title="function [Out1, Out2, Out3] = fastica(mixedsig, varargin)">FASTICA</a> (mixedsig, 'approach', 'symm', 'g', 'tanh');
               Do ICA with tanh nonlinearity and in parallel (like
               maximum likelihood estimation for supergaussian data).

       [icasig] = <a href="fastica.html" class="code" title="function [Out1, Out2, Out3] = fastica(mixedsig, varargin)">FASTICA</a> (mixedsig, 'lastEig', 10, 'numOfIC', 3);
               Reduce dimension to 10, and estimate only 3
               independent components.

       [icasig] = <a href="fastica.html" class="code" title="function [Out1, Out2, Out3] = fastica(mixedsig, varargin)">FASTICA</a> (mixedsig, 'verbose', 'off', 'displayMode', 'off');
               Don't output convergence reports and don't plot
               independent components.


 A graphical user interface for <a href="fastica.html" class="code" title="function [Out1, Out2, Out3] = fastica(mixedsig, varargin)">FASTICA</a> can be launched by the
 command <a href="fasticag.html" class="code" title="function fasticag(mixedsig, InitialGuess)">FASTICAG</a>

   See also <a href="fasticag.html" class="code" title="function fasticag(mixedsig, InitialGuess)">FASTICAG</a></pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="fpica.html" class="code" title="function [A, W] = fpica(X, whiteningMatrix, dewhiteningMatrix, approach,numOfIC, g, finetune, a1, a2, myy, stabilization,epsilon, maxNumIterations, maxFinetune, initState,guess, sampleSize, displayMode, displayInterval,s_verbose);">fpica</a>	FPICA - Fixed point ICA. Main algorithm of FASTICA.</li><li><a href="pcamat.html" class="code" title="function [E, D] = pcamat(vectors, firstEig, lastEig, s_interactive,s_verbose);">pcamat</a>	PCAMAT - Calculates the pca for data</li><li><a href="remmean.html" class="code" title="function [newVectors, meanValue] = remmean(vectors);">remmean</a>	REMMEAN - remove the mean from vectors</li><li><a href="whitenv.html" class="code" title="function [newVectors, whiteningMatrix, dewhiteningMatrix] = whitenv(vectors, E, D, s_verbose);">whitenv</a>	WHITENV - Whitenv vectors.</li></ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
</ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function [Out1, Out2, Out3] = fastica(mixedsig, varargin)</a>
0002 <span class="comment">%FASTICA - Fast Independent Component Analysis</span>
0003 <span class="comment">%</span>
0004 <span class="comment">% FastICA for Matlab 7.x and 6.x</span>
0005 <span class="comment">% Version 2.5, October 19 2005</span>
0006 <span class="comment">% Copyright (c) Hugo Gävert, Jarmo Hurri, Jaakko Särelä, and Aapo Hyvärinen.</span>
0007 <span class="comment">%</span>
0008 <span class="comment">% FASTICA(mixedsig) estimates the independent components from given</span>
0009 <span class="comment">% multidimensional signals. Each row of matrix mixedsig is one</span>
0010 <span class="comment">% observed signal.  FASTICA uses Hyvarinen's fixed-point algorithm,</span>
0011 <span class="comment">% see http://www.cis.hut.fi/projects/ica/fastica/. Output from the</span>
0012 <span class="comment">% function depends on the number output arguments:</span>
0013 <span class="comment">%</span>
0014 <span class="comment">% [icasig] = FASTICA (mixedsig); the rows of icasig contain the</span>
0015 <span class="comment">% estimated independent components.</span>
0016 <span class="comment">%</span>
0017 <span class="comment">% [icasig, A, W] = FASTICA (mixedsig); outputs the estimated separating</span>
0018 <span class="comment">% matrix W and the corresponding mixing matrix A.</span>
0019 <span class="comment">%</span>
0020 <span class="comment">% [A, W] = FASTICA (mixedsig); gives only the estimated mixing matrix</span>
0021 <span class="comment">% A and the separating matrix W.</span>
0022 <span class="comment">%</span>
0023 <span class="comment">% Some optional arguments induce other output formats, see below.</span>
0024 <span class="comment">%</span>
0025 <span class="comment">% A graphical user interface for FASTICA can be launched by the</span>
0026 <span class="comment">% command FASTICAG</span>
0027 <span class="comment">%</span>
0028 <span class="comment">% FASTICA can be called with numerous optional arguments. Optional</span>
0029 <span class="comment">% arguments are given in parameter pairs, so that first argument is</span>
0030 <span class="comment">% the name of the parameter and the next argument is the value for</span>
0031 <span class="comment">% that parameter. Optional parameter pairs can be given in any order.</span>
0032 <span class="comment">%</span>
0033 <span class="comment">% OPTIONAL PARAMETERS:</span>
0034 <span class="comment">%</span>
0035 <span class="comment">% Parameter name        Values and description</span>
0036 <span class="comment">%</span>
0037 <span class="comment">%======================================================================</span>
0038 <span class="comment">% --Basic parameters in fixed-point algorithm:</span>
0039 <span class="comment">%</span>
0040 <span class="comment">% 'approach'            (string) The decorrelation approach used. Can be</span>
0041 <span class="comment">%                       symmetric ('symm'), i.e. estimate all the</span>
0042 <span class="comment">%                       independent component in parallel, or</span>
0043 <span class="comment">%                       deflation ('defl'), i.e. estimate independent</span>
0044 <span class="comment">%                       component one-by-one like in projection pursuit.</span>
0045 <span class="comment">%                       Default is 'defl'.</span>
0046 <span class="comment">%</span>
0047 <span class="comment">% 'numOfIC'             (integer) Number of independent components to</span>
0048 <span class="comment">%                       be estimated. Default equals the dimension of data.</span>
0049 <span class="comment">%</span>
0050 <span class="comment">%======================================================================</span>
0051 <span class="comment">% --Choosing the nonlinearity:</span>
0052 <span class="comment">%</span>
0053 <span class="comment">% 'g'                   (string) Chooses the nonlinearity g used in</span>
0054 <span class="comment">%                       the fixed-point algorithm. Possible values:</span>
0055 <span class="comment">%</span>
0056 <span class="comment">%                       Value of 'g':      Nonlinearity used:</span>
0057 <span class="comment">%                       'pow3' (default)   g(u)=u^3</span>
0058 <span class="comment">%                       'tanh'             g(u)=tanh(a1*u)</span>
0059 <span class="comment">%                       'gauss             g(u)=u*exp(-a2*u^2/2)</span>
0060 <span class="comment">%                       'skew'             g(u)=u^2</span>
0061 <span class="comment">%</span>
0062 <span class="comment">% 'finetune'        (string) Chooses the nonlinearity g used when</span>
0063 <span class="comment">%                       fine-tuning. In addition to same values</span>
0064 <span class="comment">%                       as for 'g', the possible value 'finetune' is:</span>
0065 <span class="comment">%                       'off'              fine-tuning is disabled.</span>
0066 <span class="comment">%</span>
0067 <span class="comment">% 'a1'                  (number) Parameter a1 used when g='tanh'.</span>
0068 <span class="comment">%                       Default is 1.</span>
0069 <span class="comment">% 'a2'                  (number) Parameter a2 used when g='gaus'.</span>
0070 <span class="comment">%                       Default is 1.</span>
0071 <span class="comment">%</span>
0072 <span class="comment">% 'mu'            (number) Step size. Default is 1.</span>
0073 <span class="comment">%                       If the value of mu is other than 1, then the</span>
0074 <span class="comment">%                       program will use the stabilized version of the</span>
0075 <span class="comment">%                       algorithm (see also parameter 'stabilization').</span>
0076 <span class="comment">%</span>
0077 <span class="comment">%</span>
0078 <span class="comment">% 'stabilization'       (string) Values 'on' or 'off'. Default 'off'.</span>
0079 <span class="comment">%                       This parameter controls wether the program uses</span>
0080 <span class="comment">%                       the stabilized version of the algorithm or</span>
0081 <span class="comment">%                       not. If the stabilization is on, then the value</span>
0082 <span class="comment">%                       of mu can momentarily be halved if the program</span>
0083 <span class="comment">%                       senses that the algorithm is stuck between two</span>
0084 <span class="comment">%                       points (this is called a stroke). Also if there</span>
0085 <span class="comment">%                       is no convergence before half of the maximum</span>
0086 <span class="comment">%                       number of iterations has been reached then mu</span>
0087 <span class="comment">%                       will be halved for the rest of the rounds.</span>
0088 <span class="comment">%</span>
0089 <span class="comment">%======================================================================</span>
0090 <span class="comment">% --Controlling convergence:</span>
0091 <span class="comment">%</span>
0092 <span class="comment">% 'epsilon'             (number) Stopping criterion. Default is 0.0001.</span>
0093 <span class="comment">%</span>
0094 <span class="comment">% 'maxNumIterations'    (integer) Maximum number of iterations.</span>
0095 <span class="comment">%                       Default is 1000.</span>
0096 <span class="comment">%</span>
0097 <span class="comment">% 'maxFinetune'         (integer) Maximum number of iterations in</span>
0098 <span class="comment">%                       fine-tuning. Default 100.</span>
0099 <span class="comment">%</span>
0100 <span class="comment">% 'sampleSize'          (number) [0 - 1] Percentage of samples used in</span>
0101 <span class="comment">%                       one iteration. Samples are chosen in random.</span>
0102 <span class="comment">%                       Default is 1 (all samples).</span>
0103 <span class="comment">%</span>
0104 <span class="comment">% 'initGuess'           (matrix) Initial guess for A. Default is random.</span>
0105 <span class="comment">%                       You can now do a &quot;one more&quot; like this:</span>
0106 <span class="comment">%                       [ica, A, W] = fastica(mix, 'numOfIC',3);</span>
0107 <span class="comment">%                       [ica2, A2, W2] = fastica(mix, 'initGuess', A, 'numOfIC', 4);</span>
0108 <span class="comment">%</span>
0109 <span class="comment">%======================================================================</span>
0110 <span class="comment">% --Graphics and text output:</span>
0111 <span class="comment">%</span>
0112 <span class="comment">% 'verbose'             (string) Either 'on' or 'off'. Default is</span>
0113 <span class="comment">%                       'on': report progress of algorithm in text format.</span>
0114 <span class="comment">%</span>
0115 <span class="comment">% 'displayMode'         (string) Plot running estimates of independent</span>
0116 <span class="comment">%                       components: 'signals', 'basis', 'filters' or</span>
0117 <span class="comment">%                       'off'. Default is 'off'.</span>
0118 <span class="comment">%</span>
0119 <span class="comment">% 'displayInterval'     Number of iterations between plots.</span>
0120 <span class="comment">%                       Default is 1 (plot after every iteration).</span>
0121 <span class="comment">%</span>
0122 <span class="comment">%======================================================================</span>
0123 <span class="comment">% --Controlling reduction of dimension and whitening:</span>
0124 <span class="comment">%</span>
0125 <span class="comment">% Reduction of dimension is controlled by 'firstEig' and 'lastEig', or</span>
0126 <span class="comment">% alternatively by 'interactivePCA'.</span>
0127 <span class="comment">%</span>
0128 <span class="comment">% 'firstEig'            (integer) This and 'lastEig' specify the range for</span>
0129 <span class="comment">%                       eigenvalues that are retained, 'firstEig' is</span>
0130 <span class="comment">%                       the index of largest eigenvalue to be</span>
0131 <span class="comment">%                       retained. Default is 1.</span>
0132 <span class="comment">%</span>
0133 <span class="comment">% 'lastEig'             (integer) This is the index of the last (smallest)</span>
0134 <span class="comment">%                       eigenvalue to be retained. Default equals the</span>
0135 <span class="comment">%                       dimension of data.</span>
0136 <span class="comment">%</span>
0137 <span class="comment">% 'interactivePCA'      (string) Either 'on' or 'off'. When set 'on', the</span>
0138 <span class="comment">%                       eigenvalues are shown to the user and the</span>
0139 <span class="comment">%                       range can be specified interactively. Default</span>
0140 <span class="comment">%                       is 'off'. Can also be set to 'gui'. Then the user</span>
0141 <span class="comment">%                       can use the same GUI that's in FASTICAG.</span>
0142 <span class="comment">%</span>
0143 <span class="comment">% If you already know the eigenvalue decomposition of the covariance</span>
0144 <span class="comment">% matrix, you can avoid computing it again by giving it with the</span>
0145 <span class="comment">% following options:</span>
0146 <span class="comment">%</span>
0147 <span class="comment">% 'pcaE'                (matrix) Eigenvectors</span>
0148 <span class="comment">% 'pcaD'                (matrix) Eigenvalues</span>
0149 <span class="comment">%</span>
0150 <span class="comment">% If you already know the whitened data, you can give it directly to</span>
0151 <span class="comment">% the algorithm using the following options:</span>
0152 <span class="comment">%</span>
0153 <span class="comment">% 'whiteSig'            (matrix) Whitened signal</span>
0154 <span class="comment">% 'whiteMat'            (matrix) Whitening matrix</span>
0155 <span class="comment">% 'dewhiteMat'          (matrix) dewhitening matrix</span>
0156 <span class="comment">%</span>
0157 <span class="comment">% If values for all the 'whiteSig', 'whiteSig' and 'dewhiteMat' are</span>
0158 <span class="comment">% supplied, they will be used in computing the ICA. PCA and whitening</span>
0159 <span class="comment">% are not performed. Though 'mixedsig' is not used in the main</span>
0160 <span class="comment">% algorithm it still must be entered - some values are still</span>
0161 <span class="comment">% calculated from it.</span>
0162 <span class="comment">%</span>
0163 <span class="comment">% Performing preprocessing only is possible by the option:</span>
0164 <span class="comment">%</span>
0165 <span class="comment">% 'only'                (string) Compute only PCA i.e. reduction of</span>
0166 <span class="comment">%                       dimension ('pca') or only PCA plus whitening</span>
0167 <span class="comment">%                       ('white'). Default is 'all': do ICA estimation</span>
0168 <span class="comment">%                       as well.  This option changes the output</span>
0169 <span class="comment">%                       format accordingly. For example:</span>
0170 <span class="comment">%</span>
0171 <span class="comment">%                       [whitesig, WM, DWM] = FASTICA(mixedsig,</span>
0172 <span class="comment">%                       'only', 'white')</span>
0173 <span class="comment">%                       returns the whitened signals, the whitening matrix</span>
0174 <span class="comment">%                       (WM) and the dewhitening matrix (DWM). (See also</span>
0175 <span class="comment">%                       WHITENV.) In FastICA the whitening matrix performs</span>
0176 <span class="comment">%                       whitening and the reduction of dimension. Dewhitening</span>
0177 <span class="comment">%                       matrix is the pseudoinverse of whitening matrix.</span>
0178 <span class="comment">%</span>
0179 <span class="comment">%                       [E, D] = FASTICA(mixedsig, 'only', 'pca')</span>
0180 <span class="comment">%                       returns the eigenvector (E) and diagonal</span>
0181 <span class="comment">%                       eigenvalue (D) matrices  containing the</span>
0182 <span class="comment">%                       selected subspaces.</span>
0183 <span class="comment">%</span>
0184 <span class="comment">%======================================================================</span>
0185 <span class="comment">% EXAMPLES</span>
0186 <span class="comment">%</span>
0187 <span class="comment">%       [icasig] = FASTICA (mixedsig, 'approach', 'symm', 'g', 'tanh');</span>
0188 <span class="comment">%               Do ICA with tanh nonlinearity and in parallel (like</span>
0189 <span class="comment">%               maximum likelihood estimation for supergaussian data).</span>
0190 <span class="comment">%</span>
0191 <span class="comment">%       [icasig] = FASTICA (mixedsig, 'lastEig', 10, 'numOfIC', 3);</span>
0192 <span class="comment">%               Reduce dimension to 10, and estimate only 3</span>
0193 <span class="comment">%               independent components.</span>
0194 <span class="comment">%</span>
0195 <span class="comment">%       [icasig] = FASTICA (mixedsig, 'verbose', 'off', 'displayMode', 'off');</span>
0196 <span class="comment">%               Don't output convergence reports and don't plot</span>
0197 <span class="comment">%               independent components.</span>
0198 <span class="comment">%</span>
0199 <span class="comment">%</span>
0200 <span class="comment">% A graphical user interface for FASTICA can be launched by the</span>
0201 <span class="comment">% command FASTICAG</span>
0202 <span class="comment">%</span>
0203 <span class="comment">%   See also FASTICAG</span>
0204 
0205 <span class="comment">% @(#)$Id: fastica.m,v 1.14 2005/10/19 13:05:34 jarmo Exp $</span>
0206 
0207 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0208 <span class="comment">% Check some basic requirements of the data</span>
0209 <span class="keyword">if</span> nargin == 0,
0210   error (<span class="string">'You must supply the mixed data as input argument.'</span>);
0211 <span class="keyword">end</span>
0212 
0213 <span class="keyword">if</span> length (size (mixedsig)) &gt; 2,
0214   error (<span class="string">'Input data can not have more than two dimensions.'</span>);
0215 <span class="keyword">end</span>
0216 
0217 <span class="keyword">if</span> any (any (isnan (mixedsig))),
0218   error (<span class="string">'Input data contains NaN''s.'</span>);
0219 <span class="keyword">end</span>
0220 
0221 <span class="keyword">if</span> ~isa (mixedsig, <span class="string">'double'</span>)
0222   fprintf (<span class="string">'Warning: converting input data into regular (double) precision.\n'</span>);
0223   mixedsig = double (mixedsig);
0224 <span class="keyword">end</span>
0225 
0226 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0227 <span class="comment">% Remove the mean and check the data</span>
0228 
0229 [mixedsig, mixedmean] = <a href="remmean.html" class="code" title="function [newVectors, meanValue] = remmean(vectors);">remmean</a>(mixedsig);
0230 
0231 [Dim, NumOfSampl] = size(mixedsig);
0232 
0233 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0234 <span class="comment">% Default values for optional parameters</span>
0235 
0236 <span class="comment">% All</span>
0237 verbose           = <span class="string">'on'</span>;
0238 
0239 <span class="comment">% Default values for 'pcamat' parameters</span>
0240 firstEig          = 1;
0241 lastEig           = Dim;
0242 interactivePCA    = <span class="string">'off'</span>;
0243 
0244 <span class="comment">% Default values for 'fpica' parameters</span>
0245 approach          = <span class="string">'defl'</span>;
0246 numOfIC           = Dim;
0247 g                 = <span class="string">'pow3'</span>;
0248 finetune          = <span class="string">'off'</span>;
0249 a1                = 1;
0250 a2                = 1;
0251 myy               = 1;
0252 stabilization     = <span class="string">'off'</span>;
0253 epsilon           = 0.0001;
0254 maxNumIterations  = 1000;
0255 maxFinetune       = 5;
0256 initState         = <span class="string">'rand'</span>;
0257 guess             = 0;
0258 sampleSize        = 1;
0259 displayMode       = <span class="string">'off'</span>;
0260 displayInterval   = 1;
0261 
0262 
0263 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0264 <span class="comment">% Parameters for fastICA - i.e. this file</span>
0265 
0266 b_verbose = 1;
0267 jumpPCA = 0;
0268 jumpWhitening = 0;
0269 only = 3;
0270 userNumOfIC = 0;
0271 
0272 
0273 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0274 <span class="comment">% Read the optional parameters</span>
0275 
0276 <span class="keyword">if</span> (rem(length(varargin),2)==1)
0277   error(<span class="string">'Optional parameters should always go by pairs'</span>);
0278 <span class="keyword">else</span>
0279   <span class="keyword">for</span> i=1:2:(length(varargin)-1)
0280     <span class="keyword">if</span> ~ischar (varargin{i}),
0281       error ([<span class="string">'Unknown type of optional parameter name (parameter'</span> <span class="keyword">...</span>
0282           <span class="string">' names must be strings).'</span>]);
0283     <span class="keyword">end</span>
0284     <span class="comment">% change the value of parameter</span>
0285     <span class="keyword">switch</span> lower (varargin{i})
0286      <span class="keyword">case</span> <span class="string">'stabilization'</span>
0287       stabilization = lower (varargin{i+1});
0288      <span class="keyword">case</span> <span class="string">'maxfinetune'</span>
0289       maxFinetune = varargin{i+1};
0290      <span class="keyword">case</span> <span class="string">'samplesize'</span>
0291       sampleSize = varargin{i+1};
0292      <span class="keyword">case</span> <span class="string">'verbose'</span>
0293       verbose = lower (varargin{i+1});
0294       <span class="comment">% silence this program also</span>
0295       <span class="keyword">if</span> strcmp (verbose, <span class="string">'off'</span>), b_verbose = 0; <span class="keyword">end</span>
0296      <span class="keyword">case</span> <span class="string">'firsteig'</span>
0297       firstEig = varargin{i+1};
0298      <span class="keyword">case</span> <span class="string">'lasteig'</span>
0299       lastEig = varargin{i+1};
0300      <span class="keyword">case</span> <span class="string">'interactivepca'</span>
0301       interactivePCA = lower (varargin{i+1});
0302      <span class="keyword">case</span> <span class="string">'approach'</span>
0303       approach = lower (varargin{i+1});
0304      <span class="keyword">case</span> <span class="string">'numofic'</span>
0305       numOfIC = varargin{i+1};
0306       <span class="comment">% User has supplied new value for numOfIC.</span>
0307       <span class="comment">% We'll use this information later on...</span>
0308       userNumOfIC = 1;
0309      <span class="keyword">case</span> <span class="string">'g'</span>
0310       g = lower (varargin{i+1});
0311      <span class="keyword">case</span> <span class="string">'finetune'</span>
0312       finetune = lower (varargin{i+1});
0313      <span class="keyword">case</span> <span class="string">'a1'</span>
0314       a1 = varargin{i+1};
0315      <span class="keyword">case</span> <span class="string">'a2'</span>
0316       a2 = varargin{i+1};
0317      <span class="keyword">case</span> {<span class="string">'mu'</span>, <span class="string">'myy'</span>}
0318       myy = varargin{i+1};
0319      <span class="keyword">case</span> <span class="string">'epsilon'</span>
0320       epsilon = varargin{i+1};
0321      <span class="keyword">case</span> <span class="string">'maxnumiterations'</span>
0322       maxNumIterations = varargin{i+1};
0323      <span class="keyword">case</span> <span class="string">'initguess'</span>
0324       <span class="comment">% no use setting 'guess' if the 'initState' is not set</span>
0325       initState = <span class="string">'guess'</span>;
0326       guess = varargin{i+1};
0327      <span class="keyword">case</span> <span class="string">'displaymode'</span>
0328       displayMode = lower (varargin{i+1});
0329      <span class="keyword">case</span> <span class="string">'displayinterval'</span>
0330       displayInterval = varargin{i+1};
0331      <span class="keyword">case</span> <span class="string">'pcae'</span>
0332       <span class="comment">% calculate if there are enought parameters to skip PCA</span>
0333       jumpPCA = jumpPCA + 1;
0334       E = varargin{i+1};
0335      <span class="keyword">case</span> <span class="string">'pcad'</span>
0336       <span class="comment">% calculate if there are enought parameters to skip PCA</span>
0337       jumpPCA = jumpPCA + 1;
0338       D = varargin{i+1};
0339      <span class="keyword">case</span> <span class="string">'whitesig'</span>
0340       <span class="comment">% calculate if there are enought parameters to skip PCA and whitening</span>
0341       jumpWhitening = jumpWhitening + 1;
0342       whitesig = varargin{i+1};
0343      <span class="keyword">case</span> <span class="string">'whitemat'</span>
0344       <span class="comment">% calculate if there are enought parameters to skip PCA and whitening</span>
0345       jumpWhitening = jumpWhitening + 1;
0346       whiteningMatrix = varargin{i+1};
0347      <span class="keyword">case</span> <span class="string">'dewhitemat'</span>
0348       <span class="comment">% calculate if there are enought parameters to skip PCA and whitening</span>
0349       jumpWhitening = jumpWhitening + 1;
0350       dewhiteningMatrix = varargin{i+1};
0351      <span class="keyword">case</span> <span class="string">'only'</span>
0352       <span class="comment">% if the user only wants to calculate PCA or...</span>
0353       <span class="keyword">switch</span> lower (varargin{i+1})
0354        <span class="keyword">case</span> <span class="string">'pca'</span>
0355     only = 1;
0356        <span class="keyword">case</span> <span class="string">'white'</span>
0357     only = 2;
0358        <span class="keyword">case</span> <span class="string">'all'</span>
0359     only = 3;
0360       <span class="keyword">end</span>
0361       
0362      <span class="keyword">otherwise</span>
0363       <span class="comment">% Hmmm, something wrong with the parameter string</span>
0364       error([<span class="string">'Unrecognized parameter: '''</span> varargin{i} <span class="string">''''</span>]);
0365     <span class="keyword">end</span>;
0366   <span class="keyword">end</span>;
0367 <span class="keyword">end</span>
0368 
0369 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0370 <span class="comment">% print information about data</span>
0371 <span class="keyword">if</span> b_verbose
0372   fprintf(<span class="string">'Number of signals: %d\n'</span>, Dim);
0373   fprintf(<span class="string">'Number of samples: %d\n'</span>, NumOfSampl);
0374 <span class="keyword">end</span>
0375 
0376 <span class="comment">% Check if the data has been entered the wrong way,</span>
0377 <span class="comment">% but warn only... it may be on purpose</span>
0378 
0379 <span class="keyword">if</span> Dim &gt; NumOfSampl
0380   <span class="keyword">if</span> b_verbose
0381     fprintf(<span class="string">'Warning: '</span>);
0382     fprintf(<span class="string">'The signal matrix may be oriented in the wrong way.\n'</span>);
0383     fprintf(<span class="string">'In that case transpose the matrix.\n\n'</span>);
0384   <span class="keyword">end</span>
0385 <span class="keyword">end</span>
0386 
0387 
0388 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0389 <span class="comment">% Calculating PCA</span>
0390 
0391 <span class="comment">% We need the results of PCA for whitening, but if we don't</span>
0392 <span class="comment">% need to do whitening... then we dont need PCA...</span>
0393 <span class="keyword">if</span> jumpWhitening == 3
0394   <span class="keyword">if</span> b_verbose,
0395     fprintf (<span class="string">'Whitened signal and corresponding matrises supplied.\n'</span>);
0396     fprintf (<span class="string">'PCA calculations not needed.\n'</span>);
0397   <span class="keyword">end</span>;
0398 <span class="keyword">else</span>
0399   
0400   <span class="comment">% OK, so first we need to calculate PCA</span>
0401   <span class="comment">% Check to see if we already have the PCA data</span>
0402   <span class="keyword">if</span> jumpPCA == 2,
0403     <span class="keyword">if</span> b_verbose,
0404       fprintf (<span class="string">'Values for PCA calculations supplied.\n'</span>);
0405       fprintf (<span class="string">'PCA calculations not needed.\n'</span>);
0406     <span class="keyword">end</span>;
0407   <span class="keyword">else</span>
0408     <span class="comment">% display notice if the user entered one, but not both, of E and D.</span>
0409     <span class="keyword">if</span> (jumpPCA &gt; 0) &amp; (b_verbose),
0410       fprintf (<span class="string">'You must suply all of these in order to jump PCA:\n'</span>);
0411       fprintf (<span class="string">'''pcaE'', ''pcaD''.\n'</span>);
0412     <span class="keyword">end</span>;
0413     
0414     <span class="comment">% Calculate PCA</span>
0415     [E, D]=<a href="pcamat.html" class="code" title="function [E, D] = pcamat(vectors, firstEig, lastEig, s_interactive,s_verbose);">pcamat</a>(mixedsig, firstEig, lastEig, interactivePCA, verbose);
0416   <span class="keyword">end</span>
0417 <span class="keyword">end</span>
0418 
0419 <span class="comment">% skip the rest if user only wanted PCA</span>
0420 <span class="keyword">if</span> only &gt; 1
0421   
0422   <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0423   <span class="comment">% Whitening the data</span>
0424   
0425   <span class="comment">% Check to see if the whitening is needed...</span>
0426   <span class="keyword">if</span> jumpWhitening == 3,
0427     <span class="keyword">if</span> b_verbose,
0428       fprintf (<span class="string">'Whitening not needed.\n'</span>);
0429     <span class="keyword">end</span>;
0430   <span class="keyword">else</span>
0431     
0432     <span class="comment">% Whitening is needed</span>
0433     <span class="comment">% display notice if the user entered some of the whitening info, but not all.</span>
0434     <span class="keyword">if</span> (jumpWhitening &gt; 0) &amp; (b_verbose),
0435       fprintf (<span class="string">'You must suply all of these in order to jump whitening:\n'</span>);
0436       fprintf (<span class="string">'''whiteSig'', ''whiteMat'', ''dewhiteMat''.\n'</span>);
0437     <span class="keyword">end</span>;
0438     
0439     <span class="comment">% Calculate the whitening</span>
0440     [whitesig, whiteningMatrix, dewhiteningMatrix] = <a href="whitenv.html" class="code" title="function [newVectors, whiteningMatrix, dewhiteningMatrix] = whitenv(vectors, E, D, s_verbose);">whitenv</a> <span class="keyword">...</span>
0441                              (mixedsig, E, D, verbose);
0442   <span class="keyword">end</span>
0443   
0444 <span class="keyword">end</span> <span class="comment">% if only &gt; 1</span>
0445 
0446 <span class="comment">% skip the rest if user only wanted PCA and whitening</span>
0447 <span class="keyword">if</span> only &gt; 2
0448   
0449   <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0450   <span class="comment">% Calculating the ICA</span>
0451   
0452   <span class="comment">% Check some parameters</span>
0453   <span class="comment">% The dimension of the data may have been reduced during PCA calculations.</span>
0454   <span class="comment">% The original dimension is calculated from the data by default, and the</span>
0455   <span class="comment">% number of IC is by default set to equal that dimension.</span>
0456   
0457   Dim = size(whitesig, 1);
0458   
0459   <span class="comment">% The number of IC's must be less or equal to the dimension of data</span>
0460   <span class="keyword">if</span> numOfIC &gt; Dim
0461     numOfIC = Dim;
0462     <span class="comment">% Show warning only if verbose = 'on' and user supplied a value for 'numOfIC'</span>
0463     <span class="keyword">if</span> (b_verbose &amp; userNumOfIC)
0464       fprintf(<span class="string">'Warning: estimating only %d independent components\n'</span>, numOfIC);
0465       fprintf(<span class="string">'(Can''t estimate more independent components than dimension of data)\n'</span>);
0466     <span class="keyword">end</span>
0467   <span class="keyword">end</span>
0468   
0469   <span class="comment">% Calculate the ICA with fixed point algorithm.</span>
0470   [A, W] = <a href="fpica.html" class="code" title="function [A, W] = fpica(X, whiteningMatrix, dewhiteningMatrix, approach,numOfIC, g, finetune, a1, a2, myy, stabilization,epsilon, maxNumIterations, maxFinetune, initState,guess, sampleSize, displayMode, displayInterval,s_verbose);">fpica</a> (whitesig,  whiteningMatrix, dewhiteningMatrix, approach, <span class="keyword">...</span>
0471           numOfIC, g, finetune, a1, a2, myy, stabilization, epsilon, <span class="keyword">...</span>
0472           maxNumIterations, maxFinetune, initState, guess, sampleSize, <span class="keyword">...</span>
0473           displayMode, displayInterval, verbose);
0474   
0475   <span class="comment">% Check for valid return</span>
0476   <span class="keyword">if</span> ~isempty(W)
0477     <span class="comment">% Add the mean back in.</span>
0478     <span class="keyword">if</span> b_verbose
0479       fprintf(<span class="string">'Adding the mean back to the data.\n'</span>);
0480     <span class="keyword">end</span>
0481     icasig = W * mixedsig + (W * mixedmean) * ones(1, NumOfSampl);
0482     <span class="comment">%icasig = W * mixedsig;</span>
0483     <span class="keyword">if</span> b_verbose &amp; <span class="keyword">...</span>
0484       (max(abs(W * mixedmean)) &gt; 1e-9) &amp; <span class="keyword">...</span>
0485       (strcmp(displayMode,<span class="string">'signals'</span>) | strcmp(displayMode,<span class="string">'on'</span>))
0486       fprintf(<span class="string">'Note that the plots don''t have the mean added.\n'</span>);
0487     <span class="keyword">end</span>
0488   <span class="keyword">else</span>
0489     icasig = [];
0490   <span class="keyword">end</span>
0491 
0492 <span class="keyword">end</span> <span class="comment">% if only &gt; 2</span>
0493 
0494 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0495 <span class="comment">% The output depends on the number of output parameters</span>
0496 <span class="comment">% and the 'only' parameter.</span>
0497 
0498 <span class="keyword">if</span> only == 1    <span class="comment">% only PCA</span>
0499   Out1 = E;
0500   Out2 = D;
0501 <span class="keyword">elseif</span> only == 2  <span class="comment">% only PCA &amp; whitening</span>
0502   <span class="keyword">if</span> nargout == 2
0503     Out1 = whiteningMatrix;
0504     Out2 = dewhiteningMatrix;
0505   <span class="keyword">else</span>
0506     Out1 = whitesig;
0507     Out2 = whiteningMatrix;
0508     Out3 = dewhiteningMatrix;
0509   <span class="keyword">end</span>
0510 <span class="keyword">else</span>      <span class="comment">% ICA</span>
0511   <span class="keyword">if</span> nargout == 2
0512     Out1 = A;
0513     Out2 = W;
0514   <span class="keyword">else</span>
0515     Out1 = icasig;
0516     Out2 = A;
0517     Out3 = W;
0518   <span class="keyword">end</span>
0519 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Tue 18-Feb-2014 14:57:44 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>